knitr::opts_chunk$set(echo = TRUE)
data <- read.csv("caste.csv")
data
library(showtext)
showtext_auto()
library(patchwork)
library(dplyr)
library(showtext)
showtext_auto()
library(patchwork)
library(dplyr)
data <- read.csv("caste.csv")
data
data <- read.csv("clan_es.csv")
data$分类 <- factor(data$分类, levels = c("低种姓", "高种姓"))
data$parm <- factor(data$parm, levels = c("T_4", "T_3", "T_2", "T_1", "T0", "T1", "T2","T3", "T4"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4", " ", "事前2", " ", "事件发生时", " ", "事后2", " ", "事后4")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(城乡 ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p
data$分类 <- factor(data$分类, levels = c("低种姓", "高种姓"))
data$parm <- factor(data$parm, levels = c("T_4", "T_3", "T_2", "T_1", "T0", "T1", "T2","T3", "T4"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4", " ", "事前2", " ", "事件发生时", " ", "事后2", " ", "事后4")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(. ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p
data <- read.csv("caste.csv")
data
data$分类 <- factor(data$分类, levels = c("低种姓", "高种姓"))
data$parm <- factor(data$parm, levels = c("T_4", "T_3", "T_2", "T_1", "T0", "T1", "T2","T3", "T4"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4", " ", "事前2", " ", "事件发生时", " ", "事后2", " ", "事后4")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(. ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p
data <- read.csv("caste.csv")
data$分类 <- factor(data$分类, levels = c("低种姓", "高种姓"))
data$parm <- factor(data$parm, levels = c("T_4", "T_3", "T_2", "T_1", "T0", "T1", "T2","T3", "T4"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4", " ", "事前2", " ", "事件发生时", " ", "事后2", " ", "事后4")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(. ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p
data <- read.csv("caste.csv")
data$分类 <- factor(data$分类, levels = c("低种姓", "高种姓"))
data$parm <- factor(data$parm, levels = c("T_4", "T_3", "T_2", "T_1", "T0", "T1", "T2","T3", "T4"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4", " ", "事前2", " ", "事件发生时", " ", "事后2", " ", "事后4")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(. ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p
knitr::opts_chunk$set(echo = TRUE)
all$parm <- factor(all$parm , levels = c("T_4", "T_3", "T_2", "T0", "T1", "T2", "T3", "o.T4	" ))
all <- read.csv("all.csv")
UR <- read.csv("UR.csv")
all
UR
all$parm <- factor(all$parm , levels = c("T_4", "T_3", "T_2", "T0", "T1", "T2", "T3", "o.T4	" ))
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(all, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4-5", " ", "事前1", " ", "事后3-4", " ", "事后7-8", " ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey")
p
all$parm <- factor(all$parm , levels = c("T_4", "T_3", "T_2", "T0", "T1", "T2", "T3", "o.T4	" ))
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(all, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("T=-4,-5", "事前2-3 ", "事前1", " ", "事后3-4", " ", "事后7-8", " ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey")
p
all$parm <- factor(all$parm , levels = c("T_4", "T_3", "T_2", "T0", "T1", "T2", "T3", "o.T4	" ))
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(all, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("T=-4或-5", "事前2-3 ", "事前1", " ", "事后3-4", " ", "事后7-8", " ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey")
p
all$parm <- factor(all$parm , levels = c("T_4", "T_3", "T_2", "T0", "T1", "T2", "T3", "o.T4	" ))
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(all, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4-5期", "事前2-3期 ", "事前1期", " ", "事后3-4", " ", "事后7-8", " ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey")
p
all$parm <- factor(all$parm , levels = c("T_4", "T_3", "T_2", "T0", "T1", "T2", "T3", "o.T4	" ))
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(all, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4-5期", "事前2-3期 ", "事前1-0期", " 事后1-2期", "事后3-4期", " 事后5-6期", "事后7-8期", " ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey")
p
all$parm <- factor(all$parm , levels = c("T_4", "T_3", "T_2", "T0", "T1", "T2", "T3", "o.T4	" ))
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(all, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4-5期", "事前2-3期 ", "事前1-0期", " 事后1-2期", "事后3-4期", " 事后5-6期", "事后7-8期", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey")
p
all$parm <- factor(all$parm , levels = c("T_4", "T_3", "T_2", "T0", "T1", "T2", "T3", "o.T4	" ))
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(all, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4-5期", "事前2-3期 ", "事前1期-0期", " 事后1-2期", "事后3-4期", " 事后5-6期", "事后7-8期", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey")
p
UR$parm <- factor(UR$parm , levels = c("T_4", "T_3", "T_2", "T0", "T1", "T2", "T3", "T4	" ))
UR$分类 <- factor(UR$分类, levels = c("城镇", "乡村"))
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(UR, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4-5期", "事前2-3期 ", "事前1期-0期", " 事后1-2期", "事后3-4期", " 事后5-6期", "事后7-8期", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(~ 分类, scales = "free_y")
p
UR$parm <- factor(UR$parm , levels = c("T_4", "T_3", "T_2", "T0", "T1", "T2", "T3", "T4	" ))
UR$分类 <- factor(UR$分类, levels = c("城镇", "乡村"))
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(UR, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4-5期", " ", "事前1期-0期", "", "事后3-4期", "", "事后7-8期", "")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(~ 分类, scales = "free_y")
p
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(UR, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(~ 分类, scales = "free_y")
UR$parm <- factor(UR$parm , levels = c("T_4", "T_3", "T_2", "T0", "T1", "T2", "T3", "T4	" ))
UR$分类 <- factor(UR$分类, levels = c("城镇", "乡村"))
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(UR, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(~ 分类, scales = "free_y")
p
knitr::opts_chunk$set(echo = TRUE)
data$分类 <- factor(data$分类, levels = c("高母职惩罚地区", "低母职惩罚地区"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p1 <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") + ggtitle("") + theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(.~分类, scales = "free_y")+
ggtitle("生育对家庭暴力影响的事件研究法回归系数")
p1
data$分类 <- factor(data$分类, levels = c("高母职惩罚地区", "低母职惩罚地区"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p1 <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") + ggtitle("") + theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(.~分类, scales = "free_y")+
ggtitle("生育对家庭暴力影响的事件研究法回归系数")
p1
data <- read.csv("cp_es.csv")
data
data$分类 <- factor(data$分类, levels = c("高母职惩罚地区", "低母职惩罚地区"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p1 <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") + ggtitle("") + theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(.~分类, scales = "free_y")+
ggtitle("生育对家庭暴力影响的事件研究法回归系数")
p1
knitr::opts_chunk$set(echo = TRUE)
data$分类 <- factor(data$分类, levels = c("道家文化盛行地区", "道家文化并不盛行"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(. ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
print(p)
p
data <- read.csv("qing_es.csv")
data
data$分类 <- factor(data$分类, levels = c("道家文化盛行地区", "道家文化并不盛行"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(. ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
print(p)
p
data <- read.csv("qing_es.csv")
data
data$分类 <- factor(data$分类, levels = c("传统文化盛行地区", "传统文化并不盛行"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(. ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
print(p)
p
knitr::opts_chunk$set(echo = TRUE)
data <- read.csv("clan_es.csv")
data
data <- read.csv("clan_es.csv")
data$分类 <- factor(data$分类, levels = c("宗族思想较强地区", "宗族思想较弱地区"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(城乡 ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p
library(showtext)
showtext_auto()
library(patchwork)
library(dplyr)
data <- read.csv("clan_es.csv")
data
data <- read.csv("clan_es.csv")
data
data <- read.csv("clan_es.csv")
data
data <- read.csv("clan_es.csv")
data$分类 <- factor(data$分类, levels = c("宗族文化较强地区", "宗族文化较弱地区"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(城乡 ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p
data <- read.csv("clan_es.csv")
data$分类 <- factor(data$分类, levels = c("宗族文化较强地区", "宗族文化较弱地区"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(. ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p
