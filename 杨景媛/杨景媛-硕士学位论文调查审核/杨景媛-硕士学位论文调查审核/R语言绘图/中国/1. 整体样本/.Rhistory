knitr::opts_chunk$set(echo = TRUE)
# install.packages("sysfonts")
# install.packages("showtextdb")
library(showtext)
showtext_auto()
library(patchwork)
library(dplyr)
# install.packages("sysfonts")
# install.packages("showtextdb")
library(showtext)
showtext_auto()
library(patchwork)
library(dplyr)
all <- read.csv('/Users/yuan/Desktop/论文核查/杨景媛-硕士学位论文调查审核/R语言绘图/中国/1. 整体样本/all_es.csv')
UR <- read.csv('/Users/yuan/Desktop/论文核查/杨景媛-硕士学位论文调查审核/R语言绘图/中国/1. 整体样本/UR_es.csv')
all
UR
all <- read.csv('all_es.csv')
setwd("~/Desktop/论文核查/杨景媛-硕士学位论文调查审核/R语言绘图/中国/1. 整体样本")
all <- read.csv('all_es.csv')
setwd("/Users/yuan/Desktop/论文核查/杨景媛-硕士学位论文调查审核/R语言绘图/中国/1. 整体样本")
all <- read.csv("all_es.csv")
# install.packages("sysfonts")
# install.packages("showtextdb")
library(showtext)
showtext_auto()
library(patchwork)
library(dplyr)
setwd("/Users/yuan/Desktop/论文核查/杨景媛-硕士学位论文调查审核/R语言绘图/中国/1. 整体样本")
knitr::opts_knit$set(root.dir = ".")
# install.packages("sysfonts")
# install.packages("showtextdb")
library(showtext)
showtext_auto()
library(patchwork)
library(dplyr)
all <- read.csv('all_es.csv')
UR <- read.csv('UR_es.csv')
all
UR
all$parm <- factor(all$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(all, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4-5期", "事前2-3期 ", "事前1期-0期", " 事后1-2期", "事后3-4期", " 事后5-6期", "事后7-8期", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey")
p
UR$parm <- factor(UR$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
UR$分类 <- factor(UR$分类, levels = c("城镇", "乡村"))
# 绘制图形，并指定纵坐标轴的范围
p <- ggplot(UR, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(. ~ 分类, scales = "free_y")
p
knitr::opts_knit$set(root.dir = ".")
library(showtext)
showtext_auto()
library(patchwork)
library(dplyr)
data <- read.csv("tc_es.csv")
data
data$分类 <- factor(data$分类, levels = c("传统文化盛行地区", "传统文化并不盛行"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(. ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
print(p)
p
knitr::opts_knit$set(root.dir = ".")
library(showtext)
showtext_auto()
library(patchwork)
library(dplyr)
data$分类 <- factor(data$分类, levels = c("高母职惩罚地区", "低母职惩罚地区"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p1 <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") + ggtitle("") + theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(.~分类, scales = "free_y")+
ggtitle(" ")
p1
table(data$分类)
data <- read.csv("cp_es.csv")
data
data$分类 <- factor(data$分类, levels = c("高母职惩罚地区", "低母职惩罚地区"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p1 <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") + ggtitle("") + theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(.~分类, scales = "free_y")+
ggtitle(" ")
p1
knitr::opts_knit$set(root.dir = ".")
library(showtext)
showtext_auto()
library(patchwork)
library(dplyr)
data <- read.csv("clan_es.csv")   # Rmd文件和数据放在一个目录里面，就不用设置读取路径了
data
data$分类 <- factor(data$分类, levels = c("宗族文化较强地区", "宗族文化较弱地区"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
# 上面两句是把变量转为因子格式（有顺序的列表，你可以这样理解）
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) + # 画线
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +  # 画点
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +  # 画error bar
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +  # 设定x轴刻度
xlab("事件时间") + ylab("回归系数") +  # xy轴标签
theme_grey(base_family = "STKaiti") +  # 字体设置
theme_classic() +  # 画图主题设置
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +  # 线条样式设置
facet_grid(. ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p
data <- read.csv("clan_es_firstsex.csv")
data$分类 <- factor(data$分类, levels = c("宗族文化较强地区", "宗族文化较弱地区"))
data$parm <- factor(data$parm, levels = c("T_45", "T_23", "T_1", "T12", "T34", "T56", "T78", "T910"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("", "事前2-3期 ", "", " 事后1-2期", "", " 事后5-6期", "", "事后9-10期 ")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(头胎性别 ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p
knitr::opts_knit$set(root.dir = ".")
library(showtext)
showtext_auto()
data <- read.csv("ForR.csv")
knitr::opts_knit$set(root.dir = ".")
data <- read.csv("ForR.csv")
data <- read.csv("ForR.csv")
data
data$year<-as.factor(data$year)
data$year<-as.factor(data$year)
data$调查年份<-as.factor(data$调查年份)
# 绘制图形
p <- ggplot(data, aes(x = childnum, y = coef, group = 调查年份)) +
geom_line(aes(linetype = 调查年份), color = "black", position = position_dodge(width = 0.5)) +# 绘制折线
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +  # 绘制数据点
geom_errorbar(aes(ymin = low, ymax = high), width = 0.2,position = position_dodge(width = 0.5)) +  # 绘制误差线
scale_x_continuous(breaks = 1:6) + #显示每个横坐标数值
xlab("生育孩子数量") + ylab("回归系数") + ggtitle("")+ theme_grey(base_family = "STKaiti" )+
theme_classic()
# 添加y=0的虚线
p <- p + geom_hline(yintercept = 0, linetype = "dashed", color = "grey")
p
knitr::opts_knit$set(root.dir = ".")
all <- read.csv("all_india.csv")
all
bornless <- read.csv("bornless_india.csv")
bornless
bornless$parm <- factor(bornless$parm, levels = c("T_4", "T_3", "T_2", "T_1", "T0", "T1", "T2", "T3", "T4", "T5", "T6", "T7", "T8"))
bornless$分类 <- factor(bornless$分类, levels = c("全样本", "一胎家庭"))
p <- ggplot(filter(bornless, 分类 == "全样本"),
aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4期", "  ", "事前2期", "  ", "事后0期", " ", "事后2期", " ", "事后4期", " ", "事后6期", " ", "事后7期")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
theme(legend.position="none")  # 不展示图例
p
knitr::opts_knit$set(root.dir = ".")
data <- read.csv("edu_india.csv")
data
data$分类 <- factor(data$分类, levels = c("高受教育程度", "低受教育程度"))
data$parm <- factor(data$parm, levels = c("T_4", "T_3", "T_2", "T_1", "T0", "T1", "T2", "T3", "T4", "T5", "T6", "T7", "T8"))
p <- ggplot(data, aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +# 绘制折线
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +  # 绘制数据点
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2,position = position_dodge(width = 0.5)) +  # 绘制误差线
scale_x_discrete(labels = c("-4期", "  ", "-2期", "  ", "0期", " ", "2期", " ", "4期", " ", "6期", " ", "8期")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(. ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p
knitr::opts_knit$set(root.dir = ".")
data <- read.csv("cp_es_india.csv")
data
data$分类 <- factor(data$分类, levels = c("高母职惩罚地区", "低母职惩罚地区"))
data$parm <- factor(data$parm, levels = c("T_4", "T_3", "T_2", "T_1", "T0", "T1", "T2", "T3", "T4", "T5", "T6", "T7", "T8"))
p1 <- ggplot(filter(data, 受教育程度 == "高受教育程度"), aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("-4期", "  ", "-2期", "  ", "0期", " ", "2期", " ", "4期", " ", "6期", " ", "8期")) +
xlab("事件时间") + ylab("回归系数") + ggtitle("") + theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(受教育程度~分类, scales = "free_y")+
ggtitle("")
p2 <- ggplot(filter(data, 受教育程度 == "平均受教育程度"), aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("-4期", "  ", "-2期", "  ", "0期", " ", "2期", " ", "4期", " ", "6期", " ", "8期")) +
xlab("事件时间") + ylab("回归系数") + ggtitle("") + theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(受教育程度~分类, scales = "free_y")+
ggtitle("")
p1
p2
knitr::opts_knit$set(root.dir = ".")
data <- read.csv("caste.csv")
data
data <- read.csv("caste.csv")
data$分类 <- factor(data$分类, levels = c("高种姓", "低种姓"))
data$受教育程度 <- factor(data$受教育程度, levels = c("高受教育程度", "平均受教育程度"))
data <- read.csv("caste.csv")
data$分类 <- factor(data$分类, levels = c("高种姓", "低种姓"))
data$parm <- factor(data$parm, levels = c("T_4", "T_3", "T_2", "T_1", "T0", "T1", "T2", "T3", "T4", "T5", "T6", "T7", "T8"))
p1 <- ggplot(filter(data, 受教育程度 == "高受教育程度"), aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("-4期", "  ", "-2期", "  ", "0期", " ", "2期", " ", "4期", " ", "6期", " ", "8期")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(受教育程度 ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
data <- read.csv("caste.csv")
data$分类 <- factor(data$分类, levels = c("高种姓", "低种姓"))
data$parm <- factor(data$parm, levels = c("T_4", "T_3", "T_2", "T_1", "T0", "T1", "T2", "T3", "T4", "T5", "T6", "T7", "T8"))
p1 <- ggplot(filter(data, 分类 == "高种姓"), aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("-4期", "  ", "-2期", "  ", "0期", " ", "2期", " ", "4期", " ", "6期", " ", "8期")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(受教育程度 ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p2 <- ggplot(filter(data, 分类 == "低种姓"), aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("-4期", "  ", "-2期", "  ", "0期", " ", "2期", " ", "4期", " ", "6期", " ", "8期")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(受教育程度~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p1
knitr::opts_knit$set(root.dir = ".")
library(showtext)
showtext_auto()
library(patchwork)
library(dplyr)
data <- read.csv("caste.csv")
data
data <- read.csv("caste.csv")
data
data <- read.csv("caste.csv")
data
data <- read.csv("caste.csv")
data$分类 <- factor(data$分类, levels = c("高种姓", "低种姓"))
data$受教育程度 <- factor(data$受教育程度, levels = c("高受教育程度", "平均受教育程度"))
data$parm <- factor(data$parm, levels = c("T_4", "T_3", "T_2", "T_1", "T0", "T1", "T2", "T3", "T4", "T5", "T6", "T7", "T8"))
p1 <- ggplot(filter(data, 受教育程度 == "高受教育程度"), aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("-4期", "  ", "-2期", "  ", "0期", " ", "2期", " ", "4期", " ", "6期", " ", "8期")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(受教育程度 ~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p2 <- ggplot(filter(data, 受教育程度 == "平均受教育程度"), aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("-4期", "  ", "-2期", "  ", "0期", " ", "2期", " ", "4期", " ", "6期", " ", "8期")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
facet_grid(受教育程度~ 分类, scales = "free_y")  # 根据分类变量分面，y轴自由缩放
p1
p2
bornless$parm <- factor(bornless$parm, levels = c("T_4", "T_3", "T_2", "T_1", "T0", "T1", "T2", "T3", "T4", "T5", "T6", "T7", "T8"))
bornless$分类 <- factor(bornless$分类, levels = c("全样本", "一胎家庭"))
p <- ggplot(filter(bornless, 分类 == "全样本"),
aes(x = parm, y = estimate, group = 分类)) +
geom_line(color = "black", position = position_dodge(width = 0.5)) +
geom_point(position = position_dodge(width = 0.5), size = 1.5, shape = 21, fill = "black") +
geom_errorbar(aes(ymin = min90, ymax = max90), width = 0.2, position = position_dodge(width = 0.5)) +
scale_x_discrete(labels = c("事前4期", "  ", "事前2期", "  ", "事后0期", " ", "事后2期", " ", "事后4期", " ", "事后6期", " ", "事后8期")) +
xlab("事件时间") + ylab("回归系数") +
theme_grey(base_family = "STKaiti") +
theme_classic() +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
theme(legend.position="none")  # 不展示图例
p
