knitr::opts_chunk$set(echo = TRUE)
getwd()
library(dplyr)
library(tidyr)
library(showtext)
showtext_auto()
world <- read.csv("WF.csv")
p <- ggplot(selected_data, aes(x = 年份, y = 生育率, group = 国家名)) +
geom_line(aes(linetype = 国家名), color = "black", position = position_dodge(width = 0.5)) +# 绘制折线
geom_point(position = position_dodge(width = 0.5), size = 0.2, shape = 21, fill = "black") +  # 绘制数据点
xlab("年份") + ylab("总和生育率") + ggtitle("世界主要国家总和生育率趋势")+ theme_grey(base_family = "STKaiti" )+
theme_classic()
world <- read.csv("WF.csv")
showtext_auto()
world <- read.csv("WF.csv")
setwd("/Users/yuan")
library(tidyr)
library(dplyr)
library(tidyr)
library(showtext)
showtext_auto()
world <- read.csv("WF.csv")
world <- read.csv("WF.csv")
setwd("/Users/yuan/study/毕业论文- R绘图")
setwd("/Users/yuan/study/毕业论文- R绘图/世界生育率/WF.csv")
setwd("/Users/yuan/study/毕业论文- R绘图/世界生育率")
setwd("/Users/yuan/study/毕业论文- R绘图/世界生育率/WF.csv")
setwd("/Users/yuan/study/毕业论文- R绘图/世界生育率/WF.csv")
world <- read.csv("WF.csv")
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(dplyr)
library(tidyr)
library(showtext)
showtext_auto()
world <- read.csv("WF.csv")
setwd("~/study/毕业论文- R绘图/世界生育率")
world <- read.csv("WF.csv")
world
#
selected_data <- filter(world, 国家名 %in% c("United States", "India", "United Kingdom", "Korea, Rep.", "Japan", "China"))
# selected_data <- filter(world, 国家名 %in% c("India", "China"))
selected_data
world <- read.csv("WF.csv")
getwd()
#
selected_data <- filter(world, 国家名 %in% c("United States", "India", "United Kingdom", "Korea, Rep.", "Japan", "China"))
getwd()
world <- read.csv("WF.csv")
getwd()
knitr::opts_chunk$set(echo = TRUE)
getwd()
library(dplyr)
library(tidyr)
library(showtext)
showtext_auto()
getwd()
world <- read.csv("WF.csv")
world
#
selected_data <- filter(world, 国家名 %in% c("United States", "India", "United Kingdom", "Korea, Rep.", "Japan", "China"))
# selected_data <- filter(world, 国家名 %in% c("India", "China"))
selected_data
# selected_data <- filter(world, 国家名 %in% c("India", "China"))
p <- ggplot(selected_data, aes(x = 年份, y = 生育率, group = 国家名)) +
geom_line(aes(linetype = 国家名), color = "black", position = position_dodge(width = 0.5)) +# 绘制折线
geom_point(position = position_dodge(width = 0.5), size = 0.2, shape = 21, fill = "black") +  # 绘制数据点
xlab("年份") + ylab("总和生育率") + ggtitle("世界主要国家总和生育率趋势")+ theme_grey(base_family = "STKaiti" )+
theme_classic()
p <- p +
geom_hline(yintercept = 2.1, linetype = "solid", color = "red")
p
# 修改图例文字为中文
p <- p + scale_linetype_manual(values = c("solid", "dashed", "solid", "solid", "solid", "solid"),
labels = c("中国", "印度", "日本", "韩国", "英国", "美国"))
# selected_data <- filter(world, 国家名 %in% c("India", "China"))
p <- ggplot(selected_data, aes(x = 年份, y = 生育率, group = 国家名)) +
geom_line(aes(linetype = 国家名), color = "black", position = position_dodge(width = 0.5)) +# 绘制折线
geom_point(position = position_dodge(width = 0.5), size = 0.2, shape = 21, fill = "black") +  # 绘制数据点
xlab("年份") + ylab("总和生育率") + ggtitle("世界主要国家总和生育率趋势")+ theme_grey(base_family = "STKaiti" )+
theme_classic()
# 修改图例文字为中文
p <- p + scale_linetype_manual(values = c("solid", "dashed", "solid", "solid", "solid", "solid"),
labels = c("中国", "印度", "日本", "韩国", "英国", "美国"))
p <- p +
geom_hline(yintercept = 2.1, linetype = "solid", color = "red")
p
# selected_data <- filter(world, 国家名 %in% c("India", "China"))
# 绘制折线图
p <- ggplot(selected_data, aes(x = 年份, y = 生育率, group = 国家名)) +
geom_line(aes(linetype = 国家名), color = "black", position = position_dodge(width = 0.5)) +  # 绘制折线
geom_point(position = position_dodge(width = 0.5), size = 0.2, shape = 21, fill = "black") +  # 绘制数据点
xlab("年份") + ylab("总和生育率") + ggtitle("世界主要国家总和生育率趋势") +
theme_grey(base_family = "STKaiti") +  # 设置中文字体
theme_classic()
# 添加横线
p <- p + geom_hline(yintercept = 2.1, linetype = "solid", color = "red")
# 修改图例文字为中文
p <- p + scale_linetype_manual(values = c("solid", "dashed", "solid", "solid", "solid", "solid"),
labels = c("中国", "印度", "日本", "韩国", "英国", "美国"))
# 显示图形
print(p)
# selected_data <- filter(world, 国家名 %in% c("India", "China"))
# 绘制折线图
p <- ggplot(selected_data, aes(x = 年份, y = 生育率, group = 国家名)) +
geom_line(aes(linetype = 国家名), color = "black", position = position_dodge(width = 0.5)) +  # 绘制折线
geom_point(position = position_dodge(width = 0.5), size = 0.2, shape = 21, fill = "black") +  # 绘制数据点
xlab("年份") + ylab("总和生育率") + ggtitle("世界主要国家总和生育率趋势") +
theme_grey(base_family = "STKaiti") +  # 设置中文字体
theme_classic()
# 添加横线
p <- p + geom_hline(yintercept = 2.1, linetype = "solid", color = "red")
# 修改图例文字为中文
p <- p + scale_linetype_manual(values = c("solid", "dashed", "dotdash", "longdash", "dotted", "dotdash"),
labels = c("中国", "印度", "日本", "韩国", "英国", "美国"))
# 显示图形
print(p)
knitr::opts_knit$set(root.dir = ".")
library(dplyr)
library(tidyr)
library(showtext)
showtext_auto()
library(dplyr)
library(tidyr)
library(showtext)
showtext_auto()
getwd()
world <- read.csv("WF.csv")
world
#
selected_data <- filter(world, 国家名 %in% c("United States", "India", "United Kingdom", "Korea, Rep.", "Japan", "China"))
# selected_data <- filter(world, 国家名 %in% c("India", "China"))
selected_data
ggplot(data = world, aes(x = 年份, y = 生育率)) +
geom_line(data = world %>% filter(国家名== "World"), aes(linetype = "solid"), size = 1) +
xlab("年份") + ylab("总和生育率") + ggtitle("世界平均总和生育率趋势")+ theme_grey(base_family = "STKaiti" )+
theme(legend.position = "none") + # 去掉图例
theme_minimal() +
geom_hline(yintercept = 2.1, linetype = "solid", color = "red")
p <- ggplot(selected_data, aes(x = 年份, y = 生育率, group = 国家名)) +
geom_line(aes(linetype = 国家名), color = "black", position = position_dodge(width = 0.5)) +# 绘制折线
geom_point(position = position_dodge(width = 0.5), size = 0.2, shape = 21, fill = "black") +  # 绘制数据点
xlab("年份") + ylab("总和生育率") + ggtitle("世界主要国家总和生育率趋势")+ theme_grey(base_family = "STKaiti" )+
theme_classic()
p <- p +
geom_hline(yintercept = 2.1, linetype = "solid", color = "red")
p
# selected_data <- filter(world, 国家名 %in% c("India", "China"))
# 绘制折线图
p <- ggplot(selected_data, aes(x = 年份, y = 生育率, group = 国家名)) +
geom_line(aes(linetype = 国家名), color = "black", position = position_dodge(width = 0.5)) +  # 绘制折线
geom_point(position = position_dodge(width = 0.5), size = 0.2, shape = 21, fill = "black") +  # 绘制数据点
xlab("年份") + ylab("总和生育率") + ggtitle("世界主要国家总和生育率趋势") +
theme_grey(base_family = "STKaiti") +  # 设置中文字体
theme_classic()
# 添加横线
p <- p + geom_hline(yintercept = 2.1, linetype = "solid", color = "red")
# 修改图例文字为中文
p <- p + scale_linetype_manual(values = c("solid", "dashed", "dotdash", "longdash", "dotted", "dotdash"),
labels = c("中国", "印度", "日本", "韩国", "英国", "美国"))
# 显示图形
print(p)
knitr::opts_knit$set(root.dir = ".")
data <- read.csv("time_trend.csv")
# 假设你的数据框为data
list1 <- c(UR = "城镇", year = 2020, dv1 = 0.02)
list2 <- c(UR = "农村", year = 2020, dv1 = 0.02)
# 将新行添加到原始数据框
data <- rbind(data, list1, list2)
data$year <- as.numeric(data$year)
data$dv1 <- as.numeric(data$dv1)
data1$dv1 <- round(data1$dv1, 2)
data <- read.csv("time_trend.csv")
list1 <- c(UR = "城镇", year = 2020, dv1 = 0.02)
list2 <- c(UR = "农村", year = 2020, dv1 = 0.02)
# 将新行添加到原始数据框
data <- rbind(data, list1, list2)
data$year <- as.numeric(data$year)
data$dv1 <- as.numeric(data$dv1)
data1$dv1 <- round(data1$dv1, 2)
data1 <- read.csv("time_trend.csv")
list1 <- c(UR = "城镇", year = 2020, dv1 = 0.02)
list2 <- c(UR = "农村", year = 2020, dv1 = 0.02)
# 将新行添加到原始数据框
data <- rbind(data, list1, list2)
data$year <- as.numeric(data$year)
data$dv1 <- as.numeric(data$dv1)
data1$dv1 <- round(data1$dv1, 2)
data1
p <- ggplot(data, aes(x = year, y = dv1, group = UR)) +
geom_line(data = subset(data, year <= 2010), aes(color = UR, linetype = ifelse(UR == "城镇", "solid", "dashed")), show.legend = FALSE) +
geom_line(data = subset(data, year >= 2010), aes(color = UR), linetype = "dotted", color = "grey", show.legend = FALSE) +  # 2010年之后的点线
geom_point(show.legend = FALSE) +  # 设置点的图例不显示
geom_vline(xintercept = 2001, linetype = "dotted") +  # 添加垂直线
geom_text(aes(x = 2001, y = max(data$dv1), label = "2001年《离婚法》"), vjust = 0.2, hjust = 0.4) +  # 调整vjust参数
geom_vline(xintercept = 2015, linetype = "dotted") +  # 添加垂直线
geom_text(aes(x = 2015, y = max(data$dv1), label = "2015年《反家庭暴力法》"), vjust = 0.2, hjust = 0.8) +  # 调整vjust参数
geom_text(aes(x = 2020, y = 0.02, label = "（预估）"), vjust = -1, hjust = 0.5) +  # 调整vjust参数
geom_text(aes(x = 1992, y = 0.31, label = "乡村地区"), vjust = -1, hjust = 0.5) +  # 调整vjust参数
geom_text(aes(x = 1992, y = 0.21, label = "城镇地区"), vjust = -1, hjust = 0.5) +  # 调整vjust参数
labs(title = "中国家庭暴力的时间趋势图", x = "年份", y = "平均家暴发生率") +  # 不再设置 linetype 图例标题
theme_classic() +
scale_color_manual(values = c("black", "black"))  # 设置颜色
p
India <- read.csv("time_trendINDIA.csv")
# 绘制折线图
p_india <- ggplot(data = India, aes(x = year, y = dv, group = UR, color = UR, linetype = UR), show.legend = FALSE) +
geom_line() +  # 不显示图例
geom_point() +  # 不显示图例
theme_classic() +
labs(title = "印度家庭暴力的时间趋势图", x = "年份", y = "平均家暴发生率") +
scale_color_manual(values = c("black", "black"), labels = c("乡村", "城镇")) +
scale_linetype_manual(values = c("solid", "dashed"), labels = c("乡村", "城镇")) +
geom_vline(xintercept = 2005, linetype = "dotted") +
geom_text(aes(x = 2005, y = max(data$dv1), label = "2005《反家庭暴力法》"), vjust = 0.2, hjust = 0.8) +
geom_text(aes(x = 2000, y = 0.22, label = "乡村地区"), vjust = -1, hjust = 0.5) +
geom_text(aes(x = 2000, y = 0.17, label = "城镇地区"), vjust = -1, hjust = 0.5) +
theme(legend.position = "none")  # 不显示图例
p_india
# selected_data <- filter(world, 国家名 %in% c("India", "China"))
# 绘制折线图
p <- ggplot(selected_data, aes(x = 年份, y = 生育率, group = 国家名)) +
geom_line(aes(linetype = 国家名), color = "black", position = position_dodge(width = 0.5)) +  # 绘制折线
geom_point(position = position_dodge(width = 0.5), size = 0.2, shape = 21, fill = "black") +  # 绘制数据点
xlab("年份") + ylab("总和生育率") + ggtitle("世界主要国家总和生育率趋势") +
theme_grey(base_family = "STKaiti") +  # 设置中文字体
theme_classic()
# 添加横线
p <- p + geom_hline(yintercept = 2.1, linetype = "solid", color = "red")
# 修改图例文字为中文
p <- p + scale_linetype_manual(values = c("solid", "dashed", "dotted", "dotdash", "longdash", "twodash"),
labels = c("中国", "印度", "日本", "韩国", "英国", "美国"))
# 显示图形
print(p)
